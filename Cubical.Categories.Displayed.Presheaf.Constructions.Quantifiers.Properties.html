<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html" class="Module">Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Cubical.Foundations.More.html" class="Module">Cubical.Foundations.More</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Cubical.Foundations.Function.html" class="Module">Cubical.Foundations.Function</a>
<a id="208" class="Keyword">open</a> <a id="213" class="Keyword">import</a> <a id="220" href="Cubical.Foundations.Equiv.html" class="Module">Cubical.Foundations.Equiv</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Cubical.Foundations.Equiv.Dependent.html" class="Module">Cubical.Foundations.Equiv.Dependent</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Cubical.Foundations.Structure.html" class="Module">Cubical.Foundations.Structure</a>
<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Cubical.Functions.FunExtEquiv.html" class="Module">Cubical.Functions.FunExtEquiv</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Cubical.Foundations.Isomorphism.html" class="Module">Cubical.Foundations.Isomorphism</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Cubical.Foundations.Isomorphism.More.html" class="Module">Cubical.Foundations.Isomorphism.More</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>
<a id="502" class="Keyword">import</a> <a id="509" href="Cubical.Data.Equality.html" class="Module">Cubical.Data.Equality</a> <a id="531" class="Symbol">as</a> <a id="534" class="Module">Eq</a>

<a id="538" class="Keyword">open</a> <a id="543" class="Keyword">import</a> <a id="550" href="Cubical.Categories.Category.html" class="Module">Cubical.Categories.Category</a>
<a id="578" class="Keyword">open</a> <a id="583" class="Keyword">import</a> <a id="590" href="Cubical.Categories.Functor.html" class="Module">Cubical.Categories.Functor</a>
<a id="617" class="Keyword">open</a> <a id="622" class="Keyword">import</a> <a id="629" href="Cubical.Categories.Profunctor.General.html" class="Module">Cubical.Categories.Profunctor.General</a>
<a id="667" class="Keyword">open</a> <a id="672" class="Keyword">import</a> <a id="679" href="Cubical.Categories.Yoneda.html" class="Module">Cubical.Categories.Yoneda</a>
<a id="705" class="Keyword">open</a> <a id="710" class="Keyword">import</a> <a id="717" href="Cubical.Categories.Constructions.Fiber.html" class="Module">Cubical.Categories.Constructions.Fiber</a>
<a id="756" class="Keyword">open</a> <a id="761" class="Keyword">import</a> <a id="768" href="Cubical.Categories.Constructions.TotalCategory.Base.html" class="Module">Cubical.Categories.Constructions.TotalCategory.Base</a> <a id="820" class="Symbol">as</a> <a id="823" class="Module">∫</a>
<a id="825" class="Keyword">open</a> <a id="830" class="Keyword">import</a> <a id="837" href="Cubical.Categories.Limits.BinProduct.More.html" class="Module">Cubical.Categories.Limits.BinProduct.More</a>
<a id="879" class="Keyword">open</a> <a id="884" class="Keyword">import</a> <a id="891" href="Cubical.Categories.Presheaf.Base.html" class="Module">Cubical.Categories.Presheaf.Base</a>
<a id="924" class="Keyword">open</a> <a id="929" class="Keyword">import</a> <a id="936" href="Cubical.Categories.Presheaf.Morphism.Alt.html" class="Module">Cubical.Categories.Presheaf.Morphism.Alt</a>
<a id="977" class="Keyword">open</a> <a id="982" class="Keyword">import</a> <a id="989" href="Cubical.Categories.Presheaf.Representable.html" class="Module">Cubical.Categories.Presheaf.Representable</a>
<a id="1031" class="Keyword">open</a> <a id="1036" class="Keyword">import</a> <a id="1043" href="Cubical.Categories.Presheaf.Representable.More.html" class="Module">Cubical.Categories.Presheaf.Representable.More</a>
<a id="1090" class="Keyword">open</a> <a id="1095" class="Keyword">import</a> <a id="1102" href="Cubical.Categories.Presheaf.More.html" class="Module">Cubical.Categories.Presheaf.More</a>
<a id="1135" class="Keyword">open</a> <a id="1140" class="Keyword">import</a> <a id="1147" href="Cubical.Categories.Presheaf.Constructions.html" class="Module">Cubical.Categories.Presheaf.Constructions</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Cubical.Categories.Instances.Sets.html" class="Module">Cubical.Categories.Instances.Sets</a>
<a id="1235" class="Keyword">open</a> <a id="1240" class="Keyword">import</a> <a id="1247" href="Cubical.Categories.NaturalTransformation.html" class="Module">Cubical.Categories.NaturalTransformation</a> <a id="1288" class="Keyword">renaming</a> <a id="1297" class="Symbol">(</a><a id="1298" href="Cubical.Categories.NaturalTransformation.Base.html#7897" class="Function Operator">_∘ˡ_</a> <a id="1303" class="Symbol">to</a> <a id="1306" class="Function Operator">_∘ˡNT_</a><a id="1312" class="Symbol">)</a>
<a id="1314" class="Keyword">open</a> <a id="1319" class="Keyword">import</a> <a id="1326" href="Cubical.Categories.NaturalTransformation.More.html" class="Module">Cubical.Categories.NaturalTransformation.More</a>
<a id="1372" class="Keyword">open</a> <a id="1377" class="Keyword">import</a> <a id="1384" href="Cubical.Categories.FunctorComprehension.html" class="Module">Cubical.Categories.FunctorComprehension</a>

<a id="1425" class="Keyword">open</a> <a id="1430" class="Keyword">import</a> <a id="1437" href="Cubical.Categories.Displayed.Base.html" class="Module">Cubical.Categories.Displayed.Base</a>
<a id="1471" class="Keyword">open</a> <a id="1476" class="Keyword">import</a> <a id="1483" href="Cubical.Categories.Displayed.Instances.Sets.Base.html" class="Module">Cubical.Categories.Displayed.Instances.Sets.Base</a>
<a id="1532" class="Keyword">open</a> <a id="1537" class="Keyword">import</a> <a id="1544" href="Cubical.Categories.Displayed.Instances.Functor.Base.html" class="Module">Cubical.Categories.Displayed.Instances.Functor.Base</a>
<a id="1596" class="Keyword">open</a> <a id="1601" class="Keyword">import</a> <a id="1608" href="Cubical.Categories.Displayed.Functor.html" class="Module">Cubical.Categories.Displayed.Functor</a>
<a id="1645" class="Keyword">open</a> <a id="1650" class="Keyword">import</a> <a id="1657" href="Cubical.Categories.Displayed.Profunctor.html" class="Module">Cubical.Categories.Displayed.Profunctor</a>
<a id="1697" class="Keyword">open</a> <a id="1702" class="Keyword">import</a> <a id="1709" href="Cubical.Categories.Displayed.NaturalTransformation.html" class="Module">Cubical.Categories.Displayed.NaturalTransformation</a>
<a id="1760" class="Keyword">open</a> <a id="1765" class="Keyword">import</a> <a id="1772" href="Cubical.Categories.Displayed.NaturalTransformation.More.html" class="Module">Cubical.Categories.Displayed.NaturalTransformation.More</a>
<a id="1828" class="Keyword">open</a> <a id="1833" class="Keyword">import</a> <a id="1840" href="Cubical.Categories.Displayed.Functor.More.html" class="Module">Cubical.Categories.Displayed.Functor.More</a>
<a id="1882" class="Keyword">open</a> <a id="1887" class="Keyword">import</a> <a id="1894" href="Cubical.Categories.Displayed.Adjoint.More.html" class="Module">Cubical.Categories.Displayed.Adjoint.More</a>
<a id="1936" class="Keyword">open</a> <a id="1941" class="Keyword">import</a> <a id="1948" href="Cubical.Categories.Displayed.Constructions.Reindex.Base.html" class="Module">Cubical.Categories.Displayed.Constructions.Reindex.Base</a> <a id="2004" class="Symbol">as</a> <a id="2007" class="Module">Base</a>
<a id="2012" class="Keyword">open</a> <a id="2017" class="Keyword">import</a> <a id="2024" href="Cubical.Categories.Displayed.Constructions.Reindex.Properties.html" class="Module">Cubical.Categories.Displayed.Constructions.Reindex.Properties</a>
<a id="2086" class="Keyword">open</a> <a id="2091" class="Keyword">import</a> <a id="2098" href="Cubical.Categories.Displayed.Constructions.Reindex.Limits.html" class="Module">Cubical.Categories.Displayed.Constructions.Reindex.Limits</a>
<a id="2156" class="Keyword">open</a> <a id="2161" class="Keyword">import</a> <a id="2168" href="Cubical.Categories.Displayed.Fibration.Base.html" class="Module">Cubical.Categories.Displayed.Fibration.Base</a>
<a id="2212" class="Keyword">open</a> <a id="2217" class="Keyword">import</a> <a id="2224" href="Cubical.Categories.Displayed.Presheaf.html" class="Module">Cubical.Categories.Displayed.Presheaf</a>
<a id="2262" class="Keyword">open</a> <a id="2267" class="Keyword">import</a> <a id="2274" href="Cubical.Categories.Displayed.Presheaf.Constructions.Reindex.html" class="Module">Cubical.Categories.Displayed.Presheaf.Constructions.Reindex</a>
<a id="2334" class="Keyword">open</a> <a id="2339" class="Keyword">import</a> <a id="2346" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Base.html" class="Module">Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Base</a>
<a id="2415" class="Keyword">open</a> <a id="2420" class="Keyword">import</a> <a id="2427" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.UniversalProperty.html" class="Module">Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.UniversalProperty</a>
<a id="2509" class="Keyword">open</a> <a id="2514" class="Keyword">import</a> <a id="2521" href="Cubical.Categories.Displayed.FunctorComprehension.html" class="Module">Cubical.Categories.Displayed.FunctorComprehension</a>
<a id="2571" class="Keyword">import</a> <a id="2578" href="Cubical.Categories.Displayed.Presheaf.CartesianLift.html" class="Module">Cubical.Categories.Displayed.Presheaf.CartesianLift</a> <a id="2630" class="Symbol">as</a> <a id="2633" class="Module">PshᴰCL</a>

<a id="2641" class="Keyword">private</a>
  <a id="2651" class="Keyword">variable</a>
    <a id="2664" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2664" class="Generalizable">ℓC</a> <a id="2667" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2667" class="Generalizable">ℓC&#39;</a> <a id="2671" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2671" class="Generalizable">ℓCᴰ</a> <a id="2675" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2675" class="Generalizable">ℓCᴰ&#39;</a> <a id="2680" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2680" class="Generalizable">ℓ</a> <a id="2682" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2682" class="Generalizable">ℓ&#39;</a> <a id="2685" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2685" class="Generalizable">ℓP</a> <a id="2688" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2688" class="Generalizable">ℓPᴰ</a> <a id="2692" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2692" class="Generalizable">ℓQ</a> <a id="2695" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2695" class="Generalizable">ℓQᴰ</a> <a id="2699" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2699" class="Generalizable">ℓD</a> <a id="2702" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2702" class="Generalizable">ℓD&#39;</a> <a id="2706" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2706" class="Generalizable">ℓDᴰ</a> <a id="2710" href="Cubical.Categories.Displayed.Presheaf.Constructions.Quantifiers.Properties.html#2710" class="Generalizable">ℓDᴰ&#39;</a> <a id="2715" class="Symbol">:</a> <a id="2717" href="Agda.Primitive.html#742" class="Postulate">Level</a>

<a id="2724" class="Keyword">open</a> <a id="2729" href="Cubical.Categories.Functor.Base.html#418" class="Module">Functor</a>
<a id="2737" class="Keyword">open</a> <a id="2742" href="Cubical.Categories.Displayed.Functor.html#577" class="Module">Functorᴰ</a>
<a id="2751" class="Keyword">open</a> <a id="2756" href="Cubical.Categories.Presheaf.Morphism.Alt.html#3129" class="Module">PshHom</a>
<a id="2763" class="Keyword">open</a> <a id="2768" href="Cubical.Categories.Displayed.Presheaf.Morphism.html#1701" class="Module">PshHomᴰ</a>
<a id="2776" class="Keyword">open</a> <a id="2781" href="Cubical.Categories.Presheaf.Representable.html#2859" class="Module">UniversalElement</a>
<a id="2798" class="Keyword">open</a> <a id="2803" href="Cubical.Categories.Displayed.Presheaf.Representable.html#12993" class="Module">UniversalElementⱽ</a>

<a id="2822" class="Comment">-- TODO update to handle opaque reind</a>
<a id="2860" class="Comment">-- module _</a>
<a id="2872" class="Comment">--   {C : Category ℓC ℓC&#39;}</a>
<a id="2899" class="Comment">--   {D : Category ℓD ℓD&#39;}</a>
<a id="2926" class="Comment">--   {F : Functor C D}</a>
<a id="2949" class="Comment">--   {Cᴰ : Categoryᴰ C ℓCᴰ ℓCᴰ&#39;}</a>
<a id="2982" class="Comment">--   {c : C .Category.ob}</a>
<a id="3008" class="Comment">--   {Dᴰ : Categoryᴰ D ℓDᴰ ℓDᴰ&#39;}</a>
<a id="3041" class="Comment">--   (-×c : BinProductsWith C c)</a>
<a id="3074" class="Comment">--   (-×Fc : BinProductsWith D (F ⟅ c ⟆))</a>
<a id="3116" class="Comment">--   (F-× : preservesProvidedBinProductsWith F -×c)</a>
<a id="3168" class="Comment">--   where</a>
<a id="3179" class="Comment">--   private</a>
<a id="3192" class="Comment">--     module C = Category C</a>
<a id="3221" class="Comment">--     module D = Category D</a>
<a id="3250" class="Comment">--     module Cᴰ = Fibers Cᴰ</a>
<a id="3279" class="Comment">--     module Dᴰ = Fibers Dᴰ</a>
<a id="3308" class="Comment">--     F*Dᴰ = Base.reindex Dᴰ F</a>
<a id="3340" class="Comment">--     module F*Dᴰ = Fibers F*Dᴰ</a>
<a id="3373" class="Comment">--     module -×c = BinProductsWithNotation -×c</a>
<a id="3421" class="Comment">--     module -×Fc = BinProductsWithNotation -×Fc</a>
<a id="3471" class="Comment">--     module F⟨-×c⟩ {Γ} =</a>
<a id="3498" class="Comment">--       BinProductNotation</a>
<a id="3526" class="Comment">--         (preservesUniversalElement→UniversalElement</a>
<a id="3581" class="Comment">--           (preservesBinProdCones F Γ c) (-×c Γ) (F-× Γ))</a>

<a id="3642" class="Comment">--     module _ {Γ} {dᴰ : F*Dᴰ.ob[ Γ -×c.×a ]} where</a>
<a id="3695" class="Comment">--       module F⟨Γ×c⟩ =</a>
<a id="3720" class="Comment">--         BinProductNotation</a>
<a id="3750" class="Comment">--           (preservesUniversalElement→UniversalElement</a>
<a id="3807" class="Comment">--             (preservesBinProdCones F Γ c) (-×c Γ) (F-× Γ))</a>

<a id="3870" class="Comment">--   mapProdStr : ∀ {Γ} → D [ F ⟅ Γ -×c.×a ⟆ , F ⟅ Γ ⟆ -×Fc.×a ]</a>
<a id="3935" class="Comment">--   mapProdStr = F ⟪ -×c.π₁ ⟫ -×Fc.,p F ⟪ -×c.π₂ ⟫</a>

<a id="3988" class="Comment">--   mapProdStrPshHet : ∀ {Γ} →</a>
<a id="4020" class="Comment">--     PshHet F (C [-, Γ -×c.×a ]) (D [-, F ⟅ Γ ⟆ -×Fc.×a ])</a>
<a id="4081" class="Comment">--   mapProdStrPshHet = yoRec _ mapProdStr</a>

<a id="4125" class="Comment">--   prodStrNatTrans : NatTrans (F ∘F -×c.×aF) (-×Fc.×aF ∘F F)</a>
<a id="4188" class="Comment">--   prodStrNatTrans .NatTrans.N-ob _ = mapProdStr</a>
<a id="4239" class="Comment">--   prodStrNatTrans .NatTrans.N-hom f =</a>
<a id="4280" class="Comment">--     -×Fc.,p-extensionality</a>
<a id="4310" class="Comment">--       (D.⋆Assoc _ _ _</a>
<a id="4335" class="Comment">--       ∙ cong₂ D._⋆_ refl -×Fc.×β₁</a>
<a id="4372" class="Comment">--       ∙ (sym $ F .F-seq _ _ )</a>
<a id="4405" class="Comment">--       ∙ cong (F .F-hom) -×c.×β₁</a>
<a id="4440" class="Comment">--       ∙ F .F-seq _ _</a>
<a id="4464" class="Comment">--       ∙ cong₂ D._⋆_ (sym -×Fc.×β₁) refl</a>
<a id="4507" class="Comment">--       ∙ D.⋆Assoc _ _ _</a>
<a id="4533" class="Comment">--       ∙ cong₂ D._⋆_ refl (sym -×Fc.×β₁)</a>
<a id="4576" class="Comment">--       ∙ (sym $ D.⋆Assoc _ _ _))</a>
<a id="4611" class="Comment">--       (D.⋆Assoc _ _ _</a>
<a id="4636" class="Comment">--       ∙ cong₂ D._⋆_ refl -×Fc.×β₂</a>
<a id="4673" class="Comment">--       ∙ (sym $ F .F-seq _ _ )</a>
<a id="4706" class="Comment">--       ∙ cong (F .F-hom) -×c.×β₂</a>
<a id="4741" class="Comment">--       ∙ (sym -×Fc.×β₂)</a>
<a id="4767" class="Comment">--       ∙ cong₂ D._⋆_ refl (sym -×Fc.×β₂)</a>
<a id="4810" class="Comment">--       ∙ (sym $ D.⋆Assoc _ _ _))</a>

<a id="4846" class="Comment">--   -- We can build this NatTrans/Iso concretely for products, but</a>
<a id="4914" class="Comment">--   -- this should be constructible for a general functor comprehension</a>
<a id="4987" class="Comment">--   -- I believe its more complex for the abstract case because you</a>
<a id="5056" class="Comment">--   -- need to reason about a profunctor heteromorphism mediated by F</a>
<a id="5127" class="Comment">--   --</a>
<a id="5135" class="Comment">--   -- That is,</a>
<a id="5152" class="Comment">--   -- -×c.×aF is replaced with comprehension of S : Profunctor C C ℓS</a>
<a id="5224" class="Comment">--   -- -×Fc.×aF is replaced with comprehension of R : Profunctor D D ℓR</a>
<a id="5297" class="Comment">--   -- and we have a ProfHet F F S R</a>
<a id="5335" class="Comment">--   -- i.e. a natural transformation S ⇒ precomposeF (F ^op) ∘F R ∘F F</a>
<a id="5407" class="Comment">--   prodStrNatIso : NatIso (F ∘F -×c.×aF) (-×Fc.×aF ∘F F)</a>
<a id="5466" class="Comment">--   prodStrNatIso .NatIso.trans = prodStrNatTrans</a>
<a id="5517" class="Comment">--   prodStrNatIso .NatIso.nIso c =</a>
<a id="5553" class="Comment">--     isiso</a>
<a id="5566" class="Comment">--       (the-is-iso .fst -×Fc.×ue.element)</a>
<a id="5610" class="Comment">--       (-×Fc.×ue.intro-natural</a>
<a id="5643" class="Comment">--       ∙ -×Fc.×ue.intro≡</a>
<a id="5670" class="Comment">--         (the-is-iso .snd .fst -×Fc.×ue.element</a>
<a id="5720" class="Comment">--         ∙ sym (PresheafNotation.⋆IdL (BinProductProf D ⟅ _ ⟆) -×Fc.×ue.element)))</a>
<a id="5805" class="Comment">--       (F⟨-×c⟩.×ue.intro-natural</a>
<a id="5840" class="Comment">--       ∙ F⟨-×c⟩.×ue.intro≡</a>
<a id="5869" class="Comment">--           (-×Fc.×ue.universal ((F ∘F -×c.×aF) .F-ob c) .equiv-proof</a>
<a id="5940" class="Comment">--             (F-hom F (-×c.×ue.element .fst) , F-hom F (-×c.×ue.element .snd))</a>
<a id="6021" class="Comment">--             .fst .snd</a>
<a id="6046" class="Comment">--           ∙ sym (PresheafNotation.⋆IdL (BinProductProf D ⟅ _ ⟆) _)))</a>
<a id="6118" class="Comment">--     where</a>
<a id="6131" class="Comment">--     the-is-iso = isEquivToIsIso _ (F-× c ((-×Fc.×aF ∘F F) .F-ob c))</a>

<a id="6203" class="Comment">--   module _</a>
<a id="6217" class="Comment">--     (π₁*C : ∀ {Γ} →</a>
<a id="6240" class="Comment">--       (Γᴰ : Cᴰ.ob[ Γ ]) → CartesianLift Cᴰ Γᴰ -×c.π₁)</a>
<a id="6297" class="Comment">--     (π₁*D : ∀ {Δ} →</a>
<a id="6320" class="Comment">--       (Δᴰ : Dᴰ.ob[ Δ ]) → CartesianLift Dᴰ Δᴰ -×Fc.π₁)</a>
<a id="6378" class="Comment">--     where</a>

<a id="6392" class="Comment">--     private</a>
<a id="6407" class="Comment">--       module ∀ⱽCᴰ = UniversalQuantifierPsh -×c π₁*C</a>
<a id="6462" class="Comment">--       ∀ⱽPshCᴰ = ∀ⱽCᴰ.∀ⱽPsh</a>
<a id="6492" class="Comment">--       module ∀ⱽDᴰ = UniversalQuantifierPsh -×Fc π₁*D</a>
<a id="6548" class="Comment">--       ∀ⱽPshDᴰ = ∀ⱽDᴰ.∀ⱽPsh</a>

<a id="6579" class="Comment">--     module Fᴰ-weakening (Fᴰ : Functorᴰ F Cᴰ Dᴰ) where</a>

<a id="6637" class="Comment">--       Fᴰ-weakening-NatTransᴰ :</a>
<a id="6671" class="Comment">--         NatTransᴰ prodStrNatTrans</a>
<a id="6708" class="Comment">--           (Fᴰ ∘Fᴰ ∀ⱽCᴰ.weakenπFᴰ)</a>
<a id="6745" class="Comment">--           (∀ⱽDᴰ.weakenπFᴰ ∘Fᴰ Fᴰ)</a>
<a id="6782" class="Comment">--       Fᴰ-weakening-NatTransᴰ .NatTransᴰ.N-obᴰ xᴰ =</a>
<a id="6836" class="Comment">--         ∀ⱽDᴰ.introπF* $</a>
<a id="6863" class="Comment">--           Dᴰ.reind (cong (F .F-hom) (C.⋆IdL _) ∙ (sym -×Fc.×β₁)) $</a>
<a id="6933" class="Comment">--             Fᴰ .F-homᴰ (elementⱽ (π₁*C xᴰ))</a>
<a id="6980" class="Comment">--       Fᴰ-weakening-NatTransᴰ .NatTransᴰ.N-homᴰ fᴰ =</a>
<a id="7035" class="Comment">--         Dᴰ.rectify $ Dᴰ.≡out $</a>
<a id="7069" class="Comment">--           introᴰ-natural (π₁*D _)</a>
<a id="7106" class="Comment">--           ∙ introᴰ≡ (π₁*D _)</a>
<a id="7138" class="Comment">--               (change-base (D._⋆ -×Fc.π₁) D.isSetHom</a>
<a id="7194" class="Comment">--                 (-×Fc.,p-extensionality</a>
<a id="7237" class="Comment">--                   (D.⋆Assoc _ _ _</a>
<a id="7274" class="Comment">--                   ∙ D.⟨ refl ⟩⋆⟨ -×Fc.×β₁ ⟩</a>
<a id="7321" class="Comment">--                   ∙ (sym $ F .F-seq _ _)</a>
<a id="7365" class="Comment">--                   ∙ cong (F .F-hom) (-×c.×β₁)</a>
<a id="7414" class="Comment">--                   ∙ F .F-seq _ _</a>
<a id="7450" class="Comment">--                   ∙ D.⟨ sym -×Fc.×β₁ ⟩⋆⟨ refl ⟩</a>
<a id="7501" class="Comment">--                   ∙ D.⋆Assoc _ _ _</a>
<a id="7539" class="Comment">--                   ∙ D.⟨ refl ⟩⋆⟨ sym -×Fc.×β₁ ⟩</a>
<a id="7590" class="Comment">--                   ∙ (sym $ D.⋆Assoc _ _ _))</a>
<a id="7637" class="Comment">--                   (D.⋆Assoc _ _ _</a>
<a id="7674" class="Comment">--                   ∙ D.⟨ refl ⟩⋆⟨ -×Fc.×β₂ ⟩</a>
<a id="7721" class="Comment">--                   ∙ (sym $ F .F-seq _ _)</a>
<a id="7765" class="Comment">--                   ∙ cong (F .F-hom) (-×c.×β₂)</a>
<a id="7814" class="Comment">--                   ∙ sym -×Fc.×β₂</a>
<a id="7850" class="Comment">--                   ∙ D.⟨ refl ⟩⋆⟨ sym -×Fc.×β₂ ⟩</a>
<a id="7901" class="Comment">--                   ∙ (sym $ D.⋆Assoc _ _ _))</a>
<a id="7948" class="Comment">--                 ∙ (sym $ D.⋆IdR _))</a>
<a id="7987" class="Comment">--                 ((sym $ Dᴰ.reind-filler _)</a>
<a id="8033" class="Comment">--                 ∙ Dᴰ.⟨ refl ⟩⋆⟨ sym $ Dᴰ.reind-filler _ ⟩</a>
<a id="8094" class="Comment">--                 ∙ (sym $ ∫.∫F Fᴰ .F-seq _ _)</a>
<a id="8142" class="Comment">--                 ∙ cong (∫.∫F Fᴰ .F-hom)</a>
<a id="8185" class="Comment">--                     (∀ⱽCᴰ.βᴰ-πF* _</a>
<a id="8223" class="Comment">--                     ∙ (sym $ Cᴰ.reind-filler _)</a>
<a id="8274" class="Comment">--                     ∙ Cᴰ.⟨ sym $ Cᴰ.reind-filler _ ⟩⋆⟨ refl ⟩ )</a>
<a id="8341" class="Comment">--                 ∙ ∫.∫F Fᴰ .F-seq _ _</a>
<a id="8381" class="Comment">--                 ∙ Dᴰ.⟨ Dᴰ.reind-filler _ ⟩⋆⟨ refl ⟩</a>
<a id="8436" class="Comment">--                 ∙ Dᴰ.⟨ sym (∀ⱽDᴰ.βᴰ-πF* _) ⟩⋆⟨ refl ⟩</a>
<a id="8493" class="Comment">--                 ∙ Dᴰ.⋆Assoc _ _ _</a>
<a id="8530" class="Comment">--                 ∙ Dᴰ.⟨ refl ⟩⋆⟨ Dᴰ.⟨ Dᴰ.reind-filler _ ⟩⋆⟨ refl ⟩ ∙ Dᴰ.reind-filler _ ⟩</a>
<a id="8621" class="Comment">--                 ∙ Dᴰ.reind-filler _</a>
<a id="8660" class="Comment">--                 ∙ sym (∀ⱽDᴰ.βᴰ-πF* _)</a>
<a id="8701" class="Comment">--                 ∙ Dᴰ.⟨ sym (introᴰ-natural (π₁*D _)) ⟩⋆⟨ refl ⟩</a>
<a id="8768" class="Comment">--                 ∙ Dᴰ.reind-filler _))</a>

<a id="8810" class="Comment">--       Fᴰ-weakening-isNatIsoᴰ-Ty : Type _</a>
<a id="8854" class="Comment">--       Fᴰ-weakening-isNatIsoᴰ-Ty =</a>
<a id="8891" class="Comment">--         ∀ {x} (xᴰ : Cᴰ.ob[ x ]) →</a>
<a id="8928" class="Comment">--           isIsoᴰ Dᴰ (prodStrNatIso .NatIso.nIso x) (Fᴰ-weakening-NatTransᴰ .NatTransᴰ.N-obᴰ xᴰ)</a>

<a id="9028" class="Comment">--       module _</a>
<a id="9046" class="Comment">--         (Fᴰ-weakening-isNatIsoᴰ : Fᴰ-weakening-isNatIsoᴰ-Ty)</a>
<a id="9110" class="Comment">--         where</a>

<a id="9128" class="Comment">--         private</a>
<a id="9147" class="Comment">--           Fᴰ-weakening-NatIsoᴰ :</a>
<a id="9183" class="Comment">--             NatIsoᴰ prodStrNatIso</a>
<a id="9220" class="Comment">--               (Fᴰ ∘Fᴰ ∀ⱽCᴰ.weakenπFᴰ)</a>
<a id="9261" class="Comment">--               (∀ⱽDᴰ.weakenπFᴰ ∘Fᴰ Fᴰ)</a>
<a id="9302" class="Comment">--           Fᴰ-weakening-NatIsoᴰ = record {</a>
<a id="9347" class="Comment">--               transᴰ = Fᴰ-weakening-NatTransᴰ</a>
<a id="9396" class="Comment">--             ; nIsoᴰ = Fᴰ-weakening-isNatIsoᴰ }</a>

<a id="9447" class="Comment">--         module _ {Γ : C.ob} (Qⱽ : Presheafⱽ (F ⟅ Γ ⟆ -×Fc.×a) Dᴰ ℓQᴰ) where</a>
<a id="9526" class="Comment">--           private</a>
<a id="9547" class="Comment">--             module Qⱽ = PresheafⱽNotation Qⱽ</a>
<a id="9595" class="Comment">--             module ∀ⱽPshDᴰ =</a>
<a id="9627" class="Comment">--               PresheafⱽNotation (∀ⱽPshDᴰ Qⱽ)</a>
<a id="9675" class="Comment">--             module ∀ⱽPshCᴰ =</a>
<a id="9707" class="Comment">--               PresheafⱽNotation (∀ⱽPshCᴰ (reindHet&#39; mapProdStrPshHet Fᴰ Qⱽ))</a>
<a id="9787" class="Comment">--           -- This can likely be simplified using the UMP of the</a>
<a id="9854" class="Comment">--           -- quantifier</a>
<a id="9881" class="Comment">--           -- Furhter, any mention of makePshHomPath will</a>
<a id="9941" class="Comment">--           -- be replaced when we finish porting our manual PshHoms</a>
<a id="10011" class="Comment">--           -- to the locally small category of presheaves</a>
<a id="10071" class="Comment">--           reindHet∀PshIsoⱽ :</a>
<a id="10103" class="Comment">--             PshIsoⱽ</a>
<a id="10126" class="Comment">--               (reindHet&#39; (Functor→PshHet F Γ) Fᴰ (∀ⱽPshDᴰ Qⱽ))</a>
<a id="10192" class="Comment">--               (∀ⱽPshCᴰ (reindHet&#39; mapProdStrPshHet Fᴰ Qⱽ))</a>
<a id="10254" class="Comment">--           reindHet∀PshIsoⱽ =</a>
<a id="10286" class="Comment">--             reindPshIsoⱽ (Functor→PshHet F Γ) reindFuncCompIsoⱽ</a>
<a id="10353" class="Comment">--             ⋆PshIsoⱽ reind-seqIsoⱽ _ _ _</a>
<a id="10397" class="Comment">--             ⋆PshIsoⱽ reindPshIsoⱽ (Functor→PshHet F Γ ⋆PshHom</a>
<a id="10462" class="Comment">--                                    (Functor→PshHet -×Fc.×aF (F-ob F Γ) ∘ˡ F)) (reind-introIsoⱽ (NatIsoᴰ→PshIsoᴰ (symNatIsoᴰ the-nat-isoᴰ)))</a>
<a id="10605" class="Comment">--             ⋆PshIsoⱽ reind-seqIsoⱽ _ _ _</a>
<a id="10649" class="Comment">--             ⋆PshIsoⱽ</a>
<a id="10673" class="Comment">--               reindPathIsoⱽ</a>
<a id="10704" class="Comment">--                 (makePshHomPath (funExt₂ λ x p →</a>
<a id="10756" class="Comment">--                   cong₂ D._⋆_ (D.⋆IdL _ ∙ D.⋆IdR _) refl</a>
<a id="10816" class="Comment">--                   ∙ (sym $ prodStrNatIso .NatIso.trans .NatTrans.N-hom p)))</a>
<a id="10895" class="Comment">--             ⋆PshIsoⱽ invPshIsoⱽ (reind-seqIsoⱽ _ _ _)</a>
<a id="10952" class="Comment">--             ⋆PshIsoⱽ reindPshIsoⱽ (Functor→PshHet -×c.×aF Γ) annotateType</a>

<a id="11030" class="Comment">--             where</a>

<a id="11052" class="Comment">--             -- To avoid ugly goals with many reinds,</a>
<a id="11108" class="Comment">--             -- we construct the core of the PshIsoⱽ</a>
<a id="11163" class="Comment">--             -- as this NatIsoᴰ. We then turn it into a PshIsoᴰ,</a>
<a id="11230" class="Comment">--             -- turn that PshIsoᴰ into a PshIsoⱽ, and patch up</a>
<a id="11295" class="Comment">--             -- the necessary reinds in between</a>
<a id="11345" class="Comment">--             the-nat-isoᴰ :</a>
<a id="11375" class="Comment">--               NatIsoᴰ _</a>
<a id="11402" class="Comment">--                 ((Qⱽ ∘Fᴰ (Fᴰ ^opFᴰ)) ∘Fᴰ (∀ⱽCᴰ.weakenπFᴰ ^opFᴰ))</a>
<a id="11470" class="Comment">--                 ((Qⱽ ∘Fᴰ (∀ⱽDᴰ.weakenπFᴰ ^opFᴰ)) ∘Fᴰ (Fᴰ ^opFᴰ))</a>
<a id="11538" class="Comment">--             the-nat-isoᴰ =</a>
<a id="11568" class="Comment">--               (symNatIsoᴰ $ CATᴰ⋆Assoc _ _ _)</a>
<a id="11617" class="Comment">--               ⋆NatIsoᴰ (Qⱽ ∘ʳᴰⁱ</a>
<a id="11652" class="Comment">--                           (∘Fᴰ-^opFᴰ-NatIsoᴰ ∀ⱽCᴰ.weakenπFᴰ Fᴰ</a>
<a id="11718" class="Comment">--                           ⋆NatIsoᴰ opNatIsoᴰ (symNatIsoᴰ Fᴰ-weakening-NatIsoᴰ)</a>
<a id="11800" class="Comment">--                           ⋆NatIsoᴰ (symNatIsoᴰ $ ∘Fᴰ-^opFᴰ-NatIsoᴰ Fᴰ ∀ⱽDᴰ.weakenπFᴰ)))</a>
<a id="11891" class="Comment">--               ⋆NatIsoᴰ CATᴰ⋆Assoc _ _ _</a>

<a id="11935" class="Comment">--             -- This is needed because there is not enough inference if</a>
<a id="12009" class="Comment">--             -- eqToPshIsoⱽ is just used inline above</a>
<a id="12065" class="Comment">--             -- sameissue as reindFuncUnitEq in</a>
<a id="12115" class="Comment">--             -- Displayed.Presheaf.Constructions.Unit.Properties</a>
<a id="12182" class="Comment">--             annotateType :</a>
<a id="12212" class="Comment">--               PshIsoⱽ</a>
<a id="12237" class="Comment">--                 (reind (mapProdStrPshHet ∘ˡ -×c.×aF)</a>
<a id="12293" class="Comment">--                   ((Qⱽ ∘Fᴰ (Fᴰ ^opFᴰ)) ∘Fᴰ (∀ⱽCᴰ.weakenπFᴰ ^opFᴰ)))</a>
<a id="12364" class="Comment">--                 (reindHet&#39; mapProdStrPshHet Fᴰ Qⱽ</a>
<a id="12417" class="Comment">--                   ∘Fᴰ (∀ⱽCᴰ.weakenπFᴰ ^opFᴰ))</a>
<a id="12466" class="Comment">--             annotateType = eqToPshIsoⱽ (Eq.refl , Eq.refl)</a>
</pre></body></html>