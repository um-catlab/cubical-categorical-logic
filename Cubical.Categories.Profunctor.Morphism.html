<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Categories.Profunctor.Morphism</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Cubical.Categories.Profunctor.Morphism.html" class="Module">Cubical.Categories.Profunctor.Morphism</a> <a id="47" class="Keyword">where</a>

<a id="54" class="Comment">-- open import Cubical.Foundations.Prelude hiding (Path)</a>
<a id="111" class="Comment">-- open import Cubical.Foundations.Structure</a>
<a id="156" class="Comment">-- open import Cubical.Foundations.HLevels</a>
<a id="199" class="Comment">-- open import Cubical.Foundations.Isomorphism</a>
<a id="246" class="Comment">-- open import Cubical.Categories.Category</a>
<a id="289" class="Comment">-- open import Cubical.Categories.Functor</a>
<a id="331" class="Comment">-- open import Cubical.Categories.Constructions.BinProduct</a>
<a id="390" class="Comment">-- open import Cubical.Categories.NaturalTransformation</a>
<a id="446" class="Comment">-- open import Cubical.Categories.Profunctor.General</a>
<a id="499" class="Comment">-- open import Cubical.Data.Sigma</a>
<a id="533" class="Comment">-- open import Cubical.Reflection.RecordEquiv</a>

<a id="580" class="Comment">-- open import Cubical.Categories.Instances.Sets</a>
<a id="629" class="Comment">-- open import Cubical.Categories.Instances.Sets.More</a>

<a id="684" class="Comment">-- private</a>
<a id="695" class="Comment">--   variable</a>
<a id="709" class="Comment">--     ℓb ℓb&#39; ℓc ℓc&#39; ℓd ℓd&#39; ℓe ℓe&#39; ℓp ℓr : Level</a>

<a id="759" class="Comment">-- open NatTrans</a>
<a id="776" class="Comment">-- open Iso</a>

<a id="789" class="Comment">-- -- Square in a double category of functors and profunctors</a>
<a id="851" class="Comment">-- module _ {B : Category ℓb ℓb&#39;}{C : Category ℓc ℓc&#39;}</a>
<a id="906" class="Comment">--          {D : Category ℓd ℓd&#39;}{E : Category ℓe ℓe&#39;}</a>
<a id="961" class="Comment">--          (P : B o-[ ℓp ]-* C) (F : Functor B D)</a>
<a id="1012" class="Comment">--          (G : Functor C E) (R : D o-[ ℓr ]-* E) where</a>
<a id="1069" class="Comment">--   record ProfHom : Type ((ℓ-max (ℓ-max (ℓ-max (ℓ-max</a>
<a id="1125" class="Comment">--                           (ℓ-max ℓb ℓb&#39;) ℓc) ℓc&#39;) ℓp) ℓr)) where</a>
<a id="1193" class="Comment">--     field</a>
<a id="1206" class="Comment">--       R-hom : ∀ b c → ⟨ P ⟅ b , c ⟆ ⟩ → ⟨ R ⟅ F ⟅ b ⟆ , G ⟅ c ⟆ ⟆ ⟩</a>
<a id="1277" class="Comment">--       R-nat : ∀ b&#39; b c c&#39; → (f : B [ b&#39; , b ])</a>
<a id="1327" class="Comment">--               (p : ⟨ P ⟅ b , c ⟆ ⟩) (g : C [ c , c&#39; ]) →</a>
<a id="1387" class="Comment">--             R-hom _ _ ((P ⟪ f , g ⟫) p) ≡</a>
<a id="1432" class="Comment">--               (R ⟪ F ⟪ f ⟫ , G ⟪ g ⟫ ⟫) (R-hom _ _ p)</a>

<a id="1490" class="Comment">--     R-homI : ∀ {b c} → ⟨ P ⟅ b , c ⟆ ⟩ → ⟨ R ⟅ F ⟅ b ⟆ , G ⟅ c ⟆ ⟆ ⟩</a>
<a id="1562" class="Comment">--     R-homI = R-hom _ _</a>
<a id="1588" class="Comment">--     R-natI : ∀ {b&#39; b c c&#39;} →</a>
<a id="1620" class="Comment">--       (f : B [ b&#39; , b ]) (p : ⟨ P ⟅ b , c ⟆ ⟩) (g : C [ c , c&#39; ]) →</a>
<a id="1691" class="Comment">--             R-hom _ _ ((P ⟪ f , g ⟫) p) ≡</a>
<a id="1736" class="Comment">--               (R ⟪ F ⟪ f ⟫ , G ⟪ g ⟫ ⟫) (R-hom _ _ p)</a>
<a id="1793" class="Comment">--     R-natI = R-nat _ _ _ _</a>

<a id="1824" class="Comment">--   open ProfHom</a>
<a id="1842" class="Comment">--   unquoteDecl ProfHomIsoΣ = declareRecordIsoΣ ProfHomIsoΣ (quote ProfHom)</a>
<a id="1919" class="Comment">--   ProfHom≡ : ∀ ph ph&#39; → (ph .R-hom ≡ ph&#39; .R-hom) → ph ≡ ph&#39;</a>
<a id="1982" class="Comment">--   ProfHom≡ ph ph&#39; path =</a>
<a id="2010" class="Comment">--     isoFunInjective ProfHomIsoΣ ph ph&#39;</a>
<a id="2052" class="Comment">--       (Σ≡Prop (λ f → isPropΠ6</a>
<a id="2085" class="Comment">--         (λ a b c d e f&#39; → isPropΠ λ g → (R ⟅ _ , _ ⟆) .snd _ _)) path)</a>

<a id="2160" class="Comment">--   ProfHomNT : Type (ℓ-max (ℓ-max</a>
  <a id="2198" class="Comment">--   (ℓ-max (ℓ-max (ℓ-max ℓb ℓb&#39;) ℓc) ℓc&#39;) ℓp) ℓr)</a>
<a id="2249" class="Comment">--   ProfHomNT =</a>
<a id="2266" class="Comment">--     NatTrans (LiftF {ℓp} {ℓr} ∘F P) (LiftF {ℓr} {ℓp} ∘F R ∘F ((F ^opF) ×F G))</a>

<a id="2348" class="Comment">--   ProfHom→NT : ProfHom → ProfHomNT</a>
<a id="2386" class="Comment">--   ProfHom→NT ph .N-ob (b , c) f = lift (R-homI ph (f .lower))</a>
<a id="2451" class="Comment">--   ProfHom→NT ph .N-hom f = funExt λ g → cong lift (R-natI ph _ _ _)</a>

<a id="2523" class="Comment">--   NT→ProfHom : ProfHomNT → ProfHom</a>
<a id="2561" class="Comment">--   NT→ProfHom α .R-hom _ _ p = α .N-ob _ (lift p) .lower</a>
<a id="2620" class="Comment">--   NT→ProfHom α .R-nat _ _ _ _ f p g =</a>
<a id="2661" class="Comment">--     cong lower (λ i → (α .N-hom (f , g) i) (lift p) )</a>

<a id="2719" class="Comment">--   ProfHomIsoNT : Iso ProfHom ProfHomNT</a>
<a id="2761" class="Comment">--   ProfHomIsoNT .fun = ProfHom→NT</a>
<a id="2797" class="Comment">--   ProfHomIsoNT .inv = NT→ProfHom</a>
<a id="2833" class="Comment">--   ProfHomIsoNT .leftInv ph = ProfHom≡ _ _ refl</a>
<a id="2883" class="Comment">--   ProfHomIsoNT .rightInv α = makeNatTransPath refl</a>
</pre></body></html>